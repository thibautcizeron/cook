<!DOCTYPE html>
{% load static %}
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Gestion des Recettes{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="{% static '/images/index/logo.png' %}">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&display=swap" rel="stylesheet">
    <!-- Ajout de Font Awesome pour l'icône de loupe -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />

    <style>
        #recipeResults, #userMenuModal {
            position: absolute;
            z-index: 1050;
        }
        
        /* Animation pour le menu mobile */
        .mobile-menu-enter {
            transform: translateY(-100%);
            opacity: 0;
        }
        .mobile-menu-enter-active {
            transform: translateY(0);
            opacity: 1;
            transition: transform 300ms cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 300ms ease;
        }
        .mobile-menu-exit {
            transform: translateY(0);
            opacity: 1;
        }
        .mobile-menu-exit-active {
            transform: translateY(-100%);
            opacity: 0;
            transition: transform 300ms cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 300ms ease;
        }
        
        /* Styles pour le menu mobile scrollable */
        #mobileMenu {
            /* Hauteur maximale : 100vh moins la hauteur de la navbar (60px) */
            max-height: calc(100vh - 60px);
            overflow-y: auto;
            /* Smooth scrolling */
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
            scrollbar-color: rgba(156, 163, 175, 0.5) transparent;
            /* Menu par-dessus le contenu */
            position: fixed;
            top: 60px;
            bottom: 0;
            left: 0;
            right: 0;
            /* Animation d'entrée par glissement depuis le haut */
            transform: translateY(-100%);
            opacity: 0;
        }
        
        #mobileMenu.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        /* Styles pour la scrollbar webkit (Chrome, Safari, Edge) */
        #mobileMenu::-webkit-scrollbar {
            width: 6px;
        }
        
        #mobileMenu::-webkit-scrollbar-track {
            background: transparent;
        }
        
        #mobileMenu::-webkit-scrollbar-thumb {
            background-color: rgba(156, 163, 175, 0.5);
            border-radius: 3px;
        }
        
        #mobileMenu::-webkit-scrollbar-thumb:hover {
            background-color: rgba(156, 163, 175, 0.7);
        }
        
        /* Animation pour les icônes du burger menu */
        .burger-icon span {
            display: block;
            width: 100%;
            height: 2px;
            background-color: white;
            transition: all 0.3s ease;
        }
        
        .burger-open .line1 {
            transform: rotate(45deg) translate(5px, 5px);
        }
        
        .burger-open .line2 {
            opacity: 0;
        }
        
        .burger-open .line3 {
            transform: rotate(-45deg) translate(5px, -5px);
        }
        
        /* Styles pour l'affichage tablette */
        @media (min-width: 640px) and (max-width: 1023px) {
            .tablet-nav-container {
                display: grid;
                grid-template-columns: auto 1fr auto;
                align-items: center;
            }
            
            .tablet-nav-title {
                text-align: center;
                margin: 0 auto;
            }
            
            .tablet-search-container {
                position: absolute;
                top: 60px;
                left: 0;
                right: 0;
                background-color: rgba(31, 41, 55, 0.95);
                padding: 0.75rem;
                border-bottom: 1px solid rgba(75, 85, 99, 0.5);
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
                z-index: 40;
                transition: all 0.3s ease;
                transform-origin: top;
                transform: scaleY(0);
                opacity: 0;
            }
            
            .tablet-search-container.active {
                transform: scaleY(1);
                opacity: 1;
            }
            
            .search-icon {
                transition: all 0.3s ease;
            }
            
            .search-icon.active {
                color: #10B981; /* text-green-500 en Tailwind */
            }
        }
        
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        footer {
            margin-top: auto;
        }

        /* Styles modernisés pour les boutons */
        .btn-modern {
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .btn-modern:hover {
            transform: translateY(-1px);
        }

        .btn-modern:active {
            transform: translateY(0) scale(0.98);
        }

        /* Style pour boutons glassmorphism */
        .btn-glass {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }

        .btn-glass:hover {
            background: rgba(16, 185, 129, 0.1);
            border-color: rgba(16, 185, 129, 0.3);
        }

        /* Amélioration des focus states */
        .btn-modern:focus {
            outline: none;
        }
        
        /* Suppression des focus states colorés */
        button:focus, 
        input:focus, 
        select:focus, 
        textarea:focus,
        a:focus {
            outline: none !important;
            box-shadow: none !important;
        }
        
        /* Suppression des focus rings Tailwind */
        .focus\:outline-none:focus {
            outline: 2px solid transparent !important;
            outline-offset: 2px !important;
        }
        
        .focus\:ring-2:focus {
            box-shadow: none !important;
        }
        
        .focus\:ring-green-400:focus {
            box-shadow: none !important;
        }
        
        /* Suppression de tous les focus rings colorés */
        *:focus {
            outline: none !important;
            box-shadow: none !important;
        }
        
        /* Indicateur de scroll pour mobile */
        .scroll-indicator {
            position: sticky;
            bottom: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: linear-gradient(to bottom, transparent, rgba(31, 41, 55, 0.8));
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .scroll-indicator.visible {
            opacity: 1;
        }
        
        /* Amélioration du padding pour mobile */
        @media (max-width: 639px) {
            #mobileMenu .menu-content {
                padding-bottom: 2rem;
            }
        }

        /* ========================================= */
        /* STYLES POUR LE MODAL DE DÉCONNEXION MODERNISÉ */
        /* ========================================= */

        /* Animation du modal */
        .modal-backdrop {
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }
        
        .modal-enter {
            opacity: 0;
            transform: scale(0.95) translateY(-10px);
        }
        
        .modal-enter-active {
            opacity: 1;
            transform: scale(1) translateY(0);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .modal-exit {
            opacity: 1;
            transform: scale(1) translateY(0);
        }
        
        .modal-exit-active {
            opacity: 0;
            transform: scale(0.95) translateY(-10px);
            transition: all 0.2s ease-in;
        }
        
        /* Effet de brillance */
        .btn-shine::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.6s ease;
        }
        
        .btn-shine:hover::before {
            left: 100%;
        }
        
        /* Animation des particules */
        @keyframes ping {
            75%, 100% {
                transform: scale(2);
                opacity: 0;
            }
        }
        
        .animate-ping {
            animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite;
        }
        
        /* Effet de pulsation */
        .pulse-ring {
            box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);
            animation: pulse-ring 1.5s infinite;
        }
        
        @keyframes pulse-ring {
            0% {
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(239, 68, 68, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0);
            }
        }
        
        /* Grille d'arrière-plan */
        .grid-bg {
            background-image: linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px), 
                              linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 20px 20px;
        }
    </style>
</head>
<body class="bg-gray-100">
    <nav class="bg-gray-900/90 backdrop-blur shadow-md py-4 fixed top-0 w-full z-50">
        <div class="container mx-auto px-4 flex items-center justify-between lg:justify-start tablet-nav-container">
            <!-- Logo/Title for all screen sizes -->
            <h1  class="text-white text-3xl font-serif lg:absolute lg:left-1/2 lg:transform lg:-translate-x-1/2 tablet-nav-title order-2 lg:order-none transition-all duration-300 sm:ml-4 md:ml-0" style="font-family: 'DM Serif Display', serif;">
                <a href="{% url 'home' %}">COOKFAMILY</a>
            </h1>
            
            <!-- Desktop navigation links -->
            <div class="flex space-x-6 hidden lg:flex order-1">
                <a class="text-gray-200 hover:text-white font-semibold transition-all duration-300 tracking-normal hover:tracking-tight" href="{% url 'layout' %}">Home</a>
                <a class="text-gray-200 hover:text-white font-semibold transition-all duration-300 tracking-normal hover:tracking-tight" href="{% url 'layout_starts' %}">Entrées</a>
                <a class="text-gray-200 hover:text-white font-semibold transition-all duration-300 tracking-normal hover:tracking-tight" href="{% url 'layout_dishes' %}">Plats</a>
                <a class="text-gray-200 hover:text-white font-semibold transition-all duration-300 tracking-normal hover:tracking-tight" href="{% url 'layout_desserts' %}">Desserts</a>
                <a class="text-gray-200 hover:text-white font-semibold transition-all duration-300 tracking-normal hover:tracking-tight" href="{% url 'layout_cocktails' %}">Cocktails</a>
                {% if user.is_authenticated %}
                    <div class="relative group inline-block">
                        {% if is_admin or is_superuser %}
                            <button class="text-gray-200 hover:text-white font-semibold focus:outline-none">
                                Admin ▼
                            </button>
                            <div class="absolute hidden group-hover:block bg-gray-800 shadow-lg rounded-md w-48 z-50">
                                <ul class="py-2">
                                    {% if is_admin or is_superuser %}
                                        <li><a class="block px-4 py-2 text-gray-300 hover:bg-gray-700" href="{% url 'recipes_list' %}">Recettes</a></li>
                                        <li><a class="block px-4 py-2 text-gray-300 hover:bg-gray-700" href="{% url 'ingredients_list' %}">Ingrédients</a></li>
                                    {% endif %}
                                    {% if user.is_superuser %}
                                        <li><a class="block px-4 py-2 text-gray-300 hover:bg-gray-700" href="{% url 'users_list' %}">Utilisateurs</a></li>
                                        <li><a class="block px-4 py-2 text-gray-300 hover:bg-gray-700" href="{% url 'activity_logs' %}">Logs</a></li>
                                    {% endif %}
                                </ul>
                            </div>
                        {% endif %}
                    </div>
                {% endif %}
            </div>

            <!-- Search and user menu for desktop -->
            <div class="flex items-center space-x-4 ml-auto order-3">
                <!-- Desktop search input - MAINTENANT SÉPARÉ -->
                <div class="relative w-80 lg:w-80 hidden lg:block">
                    <form method="GET" action="{% url 'search_recipes' %}" class="flex">
                        <input type="text" name="q" id="searchRecipe" placeholder="Rechercher une recette..."
                            class="w-full border border-gray-600 bg-gray-800 text-white rounded-lg px-4 py-2 outline-none">
                        <!-- Bouton de recherche modernisé -->
                        <button type="submit" class="group flex items-center justify-center bg-white/5 hover:bg-emerald-500/10 border border-white/10 hover:border-emerald-500/30 rounded-xl px-3 ml-2 transition-all duration-300 backdrop-blur-sm btn-modern">
                            <div class="w-6 h-6 rounded-full bg-emerald-500/20 flex items-center justify-center group-hover:bg-emerald-500/30 transition-colors">
                                <i class="fas fa-search text-emerald-400 text-xs"></i>
                            </div>
                        </button>
                        <!-- Bouton recherche avancée modernisé -->
                        <a href="{% url 'advanced_search' %}" class="group flex items-center justify-center bg-white/5 hover:bg-blue-500/10 border border-white/10 hover:border-blue-500/30 rounded-xl px-3 ml-2 transition-all duration-300 backdrop-blur-sm btn-modern" title="Recherche avancée">
                            <div class="w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center group-hover:bg-blue-500/30 transition-colors">
                                <svg class="w-3 h-3 text-blue-400" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M2 4h20l-8 8v8l-4-2v-6L2 4z"/>
                                    <path d="M10 14v6l4 2v-8"/>
                                </svg>
                            </div>
                        </a>
                    </form>
                    <ul id="recipeResults" class="absolute bg-gray-800 text-white shadow-md mt-2 w-full hidden rounded-lg max-h-40 overflow-y-auto border border-gray-700 z-50"></ul>
                </div>
                <!-- Tablet search icon -->
                <div class="hidden sm:flex lg:hidden items-center space-x-2">
                    <button id="tabletSearchIcon" class="search-icon w-10 h-10 rounded-full bg-emerald-500/20 hover:bg-emerald-500/30 flex items-center justify-center transition-all duration-300 backdrop-blur-sm border border-white/20 hover:border-emerald-500/50 btn-modern">
                        <i class="fas fa-search text-emerald-400"></i>
                    </button>
                    
                </div>

                <!-- User menu for desktop and tablet -->
                <div class="relative hidden sm:block">
                    {% if user.is_authenticated %}
                        <button id="userMenuBtn" class="bg-gray-800 text-white w-10 h-10 rounded-full flex items-center justify-center text-xl border border-gray-600 uppercase btn-modern hover:border-emerald-500/50">
                            {{ user.username|slice:":1" }}
                        </button>
                        <div id="userMenuModal" class="absolute right-0 mt-2 bg-gray-800 shadow-lg rounded-lg w-48 hidden">
                            <ul class="py-2">
                                <li>
                                    <a href="{% url 'account' %}" class="block px-4 py-2 text-white hover:bg-gray-700">Voir mon compte</a>
                                </li>
                                <li>
                                    <button id="openLogoutModal" class="block px-4 py-2 text-red-400 hover:bg-gray-700 w-full text-left">Déconnexion</button>
                                </li>
                            </ul>
                        </div>
                    {% else %}
                        <!-- Bouton connexion modernisé -->
                        <a href="{% url 'login' %}" class="group flex items-center space-x-2 bg-white/5 hover:bg-emerald-500/10 border border-white/10 hover:border-emerald-500/30 rounded-2xl px-4 py-2 transition-all duration-300 backdrop-blur-sm btn-modern">
                            <div class="w-6 h-6 rounded-full bg-emerald-500/20 flex items-center justify-center group-hover:bg-emerald-500/30 transition-colors">
                                <svg class="w-3 h-3 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013 3v1"></path>
                                </svg>
                            </div>
                            <span class="text-gray-300 group-hover:text-white transition-colors font-medium">
                                Connexion
                            </span>
                        </a>
                    {% endif %}
                </div>

                <!-- Hamburger menu for mobile and tablet -->
                <div class="lg:hidden flex items-center">
                    <button id="burgerBtn" class="burger-icon text-gray-200 outline-none h-6 w-8 flex flex-col justify-between">
                        <span class="line1"></span>
                        <span class="line2"></span>
                        <span class="line3"></span>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Tablet-specific search bar that appears when loupe is clicked -->
        <div id="tabletSearchContainer" class="hidden sm:hidden md:block lg:hidden tablet-search-container">
            <div class="container mx-auto">
                <form method="GET" action="{% url 'search_recipes' %}" class="relative w-full">
                    <div class="flex gap-2">
                        <div class="flex flex-1">
                            <input type="text" name="q" id="searchRecipeTablet" placeholder="Rechercher une recette..."
                                class="w-full border border-gray-600 bg-gray-800 text-white rounded-lg px-4 py-2 outline-none">
                            <!-- Bouton recherche tablette modernisé -->
                            <button type="submit" class="group flex items-center justify-center bg-white/5 hover:bg-emerald-500/10 border border-white/10 hover:border-emerald-500/30 rounded-xl px-3 ml-2 transition-all duration-300 backdrop-blur-sm btn-modern">
                                <div class="w-6 h-6 rounded-full bg-emerald-500/20 flex items-center justify-center group-hover:bg-emerald-500/30 transition-colors">
                                    <i class="fas fa-search text-emerald-400 text-xs"></i>
                                </div>
                            </button>
                        </div>
                        <!-- Bouton recherche avancée tablette modernisé -->
                        <a href="{% url 'advanced_search' %}" class="group flex items-center justify-center bg-white/5 hover:bg-blue-500/10 border border-white/10 hover:border-blue-500/30 rounded-xl px-3 py-2 transition-all duration-300 backdrop-blur-sm btn-modern" title="Recherche avancée">
                            <div class="w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center group-hover:bg-blue-500/30 transition-colors">
                                <svg class="w-3 h-3 text-blue-400" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M2 4h20l-8 8v8l-4-2v-6L2 4z"/>
                                    <path d="M10 14v6l4 2v-8"/>
                                </svg>
                            </div>
                        </a>
                        <!-- Bouton fermer modernisé -->
                        <button type="button" id="closeTabletSearch" class="group flex items-center justify-center bg-white/5 hover:bg-red-500/10 border border-white/10 hover:border-red-500/30 rounded-xl px-3 py-2 transition-all duration-300 backdrop-blur-sm btn-modern">
                            <div class="w-6 h-6 rounded-full bg-red-500/20 flex items-center justify-center group-hover:bg-red-500/30 transition-colors">
                                <i class="fas fa-times text-red-400 text-xs"></i>
                            </div>
                        </button>
                    </div>
                    <ul id="recipeResultsTablet" class="absolute bg-gray-800 text-white shadow-md mt-2 w-full hidden rounded-lg max-h-40 overflow-y-auto border border-gray-700 z-50"></ul>
                </form>
            </div>
        </div>
    </nav>

    <!-- Mobile and Tablet menu -->
    <div id="mobileMenu" class="lg:hidden bg-gray-800/95 backdrop-blur-sm text-white py-4 hidden shadow-lg fixed inset-x-0 z-40 transition-all duration-300 ease-in-out" style="top: 60px; bottom: 0;">
        <div class="menu-content px-4 space-y-3">
            <a href="{% url 'layout' %}" class="block py-2 border-b border-gray-700 hover:bg-gray-700 transition-colors px-2 rounded">Home</a>
            <a href="{% url 'layout_starts' %}" class="block py-2 border-b border-gray-700 hover:bg-gray-700 transition-colors px-2 rounded">Entrées</a>
            <a href="{% url 'layout_dishes' %}" class="block py-2 border-b border-gray-700 hover:bg-gray-700 transition-colors px-2 rounded">Plats</a>
            <a href="{% url 'layout_desserts' %}" class="block py-2 border-b border-gray-700 hover:bg-gray-700 transition-colors px-2 rounded">Desserts</a>
            <a href="{% url 'layout_cocktails' %}" class="block py-2 border-b border-gray-700 hover:bg-gray-700 transition-colors px-2 rounded">Cocktails</a>
            
            <!-- Search bar in mobile menu only - hidden for tablets since they have their own search bar -->
            <div class="py-3 border-b border-gray-700 sm:hidden">
                <form method="GET" action="{% url 'search_recipes' %}" class="relative mb-3">
                    <div class="flex gap-2">
                        <input type="text" name="q" id="searchRecipeMobile" placeholder="Rechercher une recette..." 
                            class="flex-1 border border-gray-600 bg-gray-700 text-white rounded-lg px-4 py-2 outline-none">
                        <!-- Bouton recherche mobile modernisé -->
                        <button type="submit" class="group flex items-center justify-center bg-white/5 hover:bg-emerald-500/10 border border-white/10 hover:border-emerald-500/30 rounded-xl px-3 py-2 transition-all duration-300 backdrop-blur-sm btn-modern">
                            <div class="w-6 h-6 rounded-full bg-emerald-500/20 flex items-center justify-center group-hover:bg-emerald-500/30 transition-colors">
                                <i class="fas fa-search text-emerald-400 text-xs"></i>
                            </div>
                        </button>
                    </div>
                    <ul id="recipeResultsMobile" class="bg-gray-700 text-white shadow-md mt-2 w-full hidden rounded-lg max-h-40 overflow-y-auto border border-gray-700 z-50"></ul>
                </form>
                <!-- Bouton recherche avancée pour mobile - maintenant séparé et modernisé -->
                <div class="flex items-center justify-center mt-3">
                    <a href="{% url 'advanced_search' %}" class="group flex items-center space-x-3 bg-white/5 hover:bg-blue-500/10 border border-white/10 hover:border-blue-500/30 rounded-2xl px-4 py-2 transition-all duration-300 backdrop-blur-sm btn-modern">
                        <div class="w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center group-hover:bg-blue-500/30 transition-colors">
                            <svg class="w-3 h-3 text-blue-400" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M2 4h20l-8 8v8l-4-2v-6L2 4z"/>
                                <path d="M10 14v6l4 2v-8"/>
                            </svg>
                        </div>
                        <span class="text-gray-300 group-hover:text-white transition-colors font-medium text-sm">
                            Recherche avancée
                        </span>
                    </a>
                </div>
            </div>
            
            {% if user.is_authenticated %}
                {% if is_admin or is_superuser %}
                    <div class="pt-2">
                        <p class="text-gray-400 text-sm font-semibold">Admin</p>
                        <div class="pl-2 mt-1 space-y-2">
                            <a href="{% url 'recipes_list' %}" class="block py-1 px-2 hover:bg-gray-700 rounded">Recettes</a>
                            <a href="{% url 'ingredients_list' %}" class="block py-1 px-2 hover:bg-gray-700 rounded">Ingrédients</a>
                            {% if user.is_superuser %}
                                <a href="{% url 'users_list' %}" class="block py-1 px-2 hover:bg-gray-700 rounded">Utilisateurs</a>
                                <a href="{% url 'activity_logs' %}" class="block py-1 px-2 hover:bg-gray-700 rounded">Logs</a>
                            {% endif %}
                        </div>
                    </div>
                {% endif %}
                <!-- User menu in mobile menu only - hidden for tablets as they have the user menu in the navbar -->
                <div class="pt-3 flex flex-col space-y-2 sm:hidden">
                    <a href="{% url 'account' %}" class="block py-2 hover:bg-gray-700 transition-colors px-2 rounded">
                        <span class="flex items-center">
                            <span class="bg-gray-700 text-white w-8 h-8 rounded-full flex items-center justify-center text-lg mr-2 uppercase">
                                {{ user.username|slice:":1" }}
                            </span>
                            <span>Voir mon compte</span>
                        </span>
                    </a>
                    <button id="openLogoutModalMobile" class="block text-left py-2 text-red-400 w-full hover:bg-gray-700 px-2 rounded">Déconnexion</button>
                </div>
            {% else %}
                <!-- Login button in mobile menu only - hidden for tablets as they have the button in the navbar -->
                <div class="mt-3 sm:hidden">
                    <a href="{% url 'login' %}" class="group flex items-center justify-center space-x-3 bg-white/5 hover:bg-emerald-500/10 border border-white/10 hover:border-emerald-500/30 rounded-2xl px-4 py-3 transition-all duration-300 backdrop-blur-sm btn-modern">
                        <div class="w-6 h-6 rounded-full bg-emerald-500/20 flex items-center justify-center group-hover:bg-emerald-500/30 transition-colors">
                            <svg class="w-3 h-3 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013 3v1"></path>
                            </svg>
                        </div>
                        <span class="text-gray-300 group-hover:text-white transition-colors font-medium">
                            Connexion
                        </span>
                    </a>
                </div>
            {% endif %}
        </div>
        
        <!-- Indicateur de scroll -->
        <div id="scrollIndicator" class="scroll-indicator"></div>
    </div>

    <div class="w-full bg-gray-800 min-h-screen pt-16 pb-0">
        {% block content %}{% endblock %}
    </div>

    <!-- ========================================= -->
    <!-- MODAL DE DÉCONNEXION MODERNISÉ -->
    <!-- ========================================= -->
    <div id="logoutModal" class="fixed inset-0 bg-gray-900/80 modal-backdrop hidden flex justify-center items-center z-50 p-4">
        <!-- Overlay avec effet de grille -->
        <div class="absolute inset-0 grid-bg opacity-10"></div>
        
        <!-- Effets lumineux en arrière-plan -->
        <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-red-500/5 rounded-full blur-3xl"></div>
        <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-orange-500/5 rounded-full blur-3xl"></div>
        
        <!-- Container du modal -->
        <div class="bg-gray-800/90 backdrop-blur-sm border border-gray-700/50 rounded-2xl shadow-2xl p-6 w-full max-w-sm mx-4 relative z-10 modal-enter">
            <!-- Icône d'alerte modernisée -->
            <div class="text-center mb-6">
                <div class="mx-auto w-14 h-14 bg-gradient-to-br from-red-500/20 to-orange-500/20 rounded-2xl flex items-center justify-center mb-4 backdrop-blur-sm border border-red-500/30">
                    <svg class="w-7 h-7 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                    </svg>
                </div>
                <h2 class="text-xl font-semibold text-white mb-2">Déconnexion</h2>
                <p class="text-gray-400 text-sm">
                    Confirmer la déconnexion ?
                </p>
            </div>

            <!-- Boutons d'action -->
            <div class="grid grid-cols-2 gap-3">
                <!-- Bouton Annuler -->
                <button id="cancelLogout" class="bg-white/5 hover:bg-gray-600/20 border border-white/10 hover:border-gray-500/30 rounded-xl px-4 py-3 font-medium text-gray-300 hover:text-white transition-all duration-300 backdrop-blur-sm btn-modern">
                    Annuler
                </button>
                
                <!-- Bouton Confirmer avec form Django -->
                <button type="submit" form="logoutForm" id="confirmLogout" class="bg-red-600 hover:bg-red-500 text-white font-medium rounded-xl px-4 py-3 shadow-lg hover:shadow-xl transition-all duration-300 btn-modern">
                    Confirmer
                </button>
            </div>
            
            <!-- Form caché -->
            <form id="logoutForm" action="{% url 'logout' %}" method="post" class="hidden">
                {% csrf_token %}
            </form>
        </div>
    </div>

    
    <footer class="bg-gray-900 text-gray-300 py-8 mt-0">
        <div class="container mx-auto px-6 lg:px-20">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h2 class="text-lg font-semibold text-white">A propos</h2>
                    <p class="text-gray-400 text-sm mt-2">
                        Découvrez et partagez des recettes inspirantes. Ce site est une plateforme dédiée aux passionnés de cuisine.
                    </p>
                </div>
                <div>
                    <h2 class="text-lg font-semibold text-white">Liens utiles</h2>
                    <ul class="mt-2 space-y-2">
                        <li><a href="{% url 'layout' %}" class="hover:text-white transition">Accueil</a></li>
                        <li><a href="{% url 'search_recipes' %}" class="hover:text-white transition">Toutes les recettes</a></li>
                        <li><a href="{% url 'contact' %}" class="hover:text-white transition">Contact</a></li>
                    </ul>
                </div>
                <div>
                    <h2 class="text-lg font-semibold text-white">Mentions légales</h2>
                    <ul class="mt-2 space-y-2">
                        <li><a href="{% url 'mentions' %}" class="hover:text-white transition">Mentions légales</a></li>
                        <li><a href="{% url 'politique' %}" class="hover:text-white transition">Politique de confidentialité</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-700 my-6"></div>
            <div class="text-center text-sm">&copy; 2025 - CookFamily. Tous droits réservés.</div>
        </div>
    </footer>


    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.min.js"></script>
    <script>
        $(document).ready(function() {
            // Fonctions pour la recherche sur différents dispositifs
            $("#searchRecipe").on("input", function() {
                let query = $(this).val().trim();
                handleSearchSuggestions(query, "#recipeResults");
            });
            
            $("#searchRecipeMobile").on("input", function() {
                let query = $(this).val().trim();
                handleSearchSuggestions(query, "#recipeResultsMobile");
            });
            
            // Fonction pour la recherche tablette
            $("#searchRecipeTablet").on("input", function() {
                let query = $(this).val().trim();
                handleSearchSuggestions(query, "#recipeResultsTablet");
            });
            
            // Fonction pour les suggestions de recherche (autocomplétion)
            function handleSearchSuggestions(query, resultSelector) {
                if (query.length > 1) {
                    $.ajax({
                        url: "{% url 'search_recipe_api' %}",
                        data: { q: query },
                        dataType: 'json',
                        success: function(data) {
                            let results = $(resultSelector);
                            results.empty().removeClass("hidden");
                            if (data.length > 0) {
                                data.forEach(function(recette) {
                                    results.append(`
                                        <li><a href="/recettes/${recette.id}/" class="block px-4 py-2 hover:bg-gray-600">
                                            <div class="flex justify-between items-center">
                                                <span>${recette.titre}</span>
                                                <span class="text-sm text-gray-400">${recette.categorie}</span>
                                            </div>
                                        </a></li>
                                    `);
                                });
                                
                                // Ajouter un lien "Voir tous les résultats"
                                results.append(`
                                    <li class="border-t border-gray-700">
                                        <a href="/search/?q=${encodeURIComponent(query)}" class="block px-4 py-2 hover:bg-gray-600 text-green-400 font-medium">
                                            <div class="flex items-center">
                                                <i class="fas fa-search mr-2"></i>
                                                Voir tous les résultats
                                            </div>
                                        </a>
                                    </li>
                                `);
                            } else {
                                results.append(`<li class="px-4 py-2 text-gray-500">Aucune recette trouvée.</li>`);
                            }
                        }
                    });
                } else {
                    $(resultSelector).empty().addClass("hidden");
                }
            }

            // Cacher les résultats quand on clique ailleurs
            $(document).on("click", function(e) {
                if (!$(e.target).closest("#searchRecipe, #recipeResults").length) {
                    $("#recipeResults").addClass("hidden");
                }
                
                if (!$(e.target).closest("#searchRecipeMobile, #recipeResultsMobile").length) {
                    $("#recipeResultsMobile").addClass("hidden");
                }
                
                if (!$(e.target).closest("#searchRecipeTablet, #recipeResultsTablet, #tabletSearchIcon").length) {
                    $("#recipeResultsTablet").addClass("hidden");
                }
                
                // Fermer le menu utilisateur quand on clique ailleurs
                if (!$(e.target).closest("#userMenuBtn, #userMenuModal").length) {
                    $("#userMenuModal").addClass("hidden");
                }
            });
            
            // Toggle du menu utilisateur
            $("#userMenuBtn").on("click", function() {
                $("#userMenuModal").toggleClass("hidden");
            });
            
            // Toggle de la recherche tablette avec l'icône loupe
            $("#tabletSearchIcon").on("click", function() {
                const searchContainer = $("#tabletSearchContainer");
                searchContainer.toggleClass("active");
                $(this).toggleClass("active");
                
                // Si le conteneur de recherche est maintenant ouvert, focus sur l'input
                if (searchContainer.hasClass("active")) {
                    setTimeout(() => {
                        $("#searchRecipeTablet").focus();
                    }, 300); // Un délai pour attendre la fin de l'animation
                }
            });
            
            // Fermer la recherche tablette avec le bouton X
            $("#closeTabletSearch").on("click", function() {
                $("#tabletSearchContainer").removeClass("active");
                $("#tabletSearchIcon").removeClass("active");
                $("#searchRecipeTablet").val(""); // Vider l'input
                $("#recipeResultsTablet").empty().addClass("hidden"); // Vider et cacher les résultats
            });
        });

        document.addEventListener("DOMContentLoaded", function() {
            const burgerBtn = document.getElementById("burgerBtn");
            const mobileMenu = document.getElementById("mobileMenu");
            const scrollIndicator = document.getElementById("scrollIndicator");

            // ========================================= 
            // GESTION DU MODAL DE DÉCONNEXION MODERNISÉ
            // =========================================
            const logoutBtnMobile = document.getElementById("openLogoutModalMobile");
            const logoutBtn = document.getElementById("openLogoutModal");
            const cancelLogout = document.getElementById("cancelLogout");
            const logoutModal = document.getElementById("logoutModal");
            const modalContent = logoutModal ? logoutModal.querySelector('.modal-enter') : null;

            // Fonction pour ouvrir le modal avec animation
            function openModal() {
                if (logoutModal && modalContent) {
                    logoutModal.classList.remove('hidden');
                    modalContent.classList.remove('modal-enter');
                    modalContent.classList.add('modal-enter-active');
                    
                    // Focus sur le bouton annuler pour l'accessibilité
                    setTimeout(() => {
                        if (cancelLogout) cancelLogout.focus();
                    }, 150);
                }
            }

            // Fonction pour fermer le modal avec animation
            function closeModal() {
                if (modalContent && logoutModal) {
                    modalContent.classList.remove('modal-enter-active');
                    modalContent.classList.add('modal-exit-active');
                    
                    setTimeout(() => {
                        logoutModal.classList.add('hidden');
                        modalContent.classList.remove('modal-exit-active');
                        modalContent.classList.add('modal-enter');
                    }, 200);
                }
            }

            // Event listeners pour ouvrir le modal
            if (logoutBtnMobile) {
                logoutBtnMobile.addEventListener("click", openModal);
            }

            if (logoutBtn) {
                logoutBtn.addEventListener("click", openModal);
            }

            // Event listener pour fermer le modal
            if (cancelLogout) {
                cancelLogout.addEventListener("click", closeModal);
            }
            
            // Fermer le modal en cliquant sur l'overlay
            if (logoutModal) {
                logoutModal.addEventListener("click", function(e) {
                    if (e.target === logoutModal) {
                        closeModal();
                    }
                });
            }
            
            // Animation de chargement lors de la soumission du formulaire
            const confirmLogoutBtn = document.getElementById("confirmLogout");
            const logoutForm = document.getElementById("logoutForm");
            
            if (logoutForm && confirmLogoutBtn) {
                logoutForm.addEventListener("submit", function(e) {
                    // Animation de chargement
                    confirmLogoutBtn.innerHTML = `
                        <div class="relative z-10 flex items-center space-x-3">
                            <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div>
                            <span>Déconnexion...</span>
                        </div>
                    `;
                    confirmLogoutBtn.disabled = true;
                });
            }

            // ========================================= 
            // GESTION DU MENU MOBILE (CODE EXISTANT)
            // =========================================

            // Fonction pour vérifier si le contenu du menu déborde
            function checkMenuScroll() {
                if (mobileMenu && !mobileMenu.classList.contains("hidden")) {
                    const isScrollable = mobileMenu.scrollHeight > mobileMenu.clientHeight;
                    const isScrolledToBottom = Math.abs(mobileMenu.scrollHeight - mobileMenu.clientHeight - mobileMenu.scrollTop) < 1;
                    
                    if (scrollIndicator) {
                        if (isScrollable && !isScrolledToBottom) {
                            scrollIndicator.classList.add("visible");
                        } else {
                            scrollIndicator.classList.remove("visible");
                        }
                    }
                }
            }

            // Écouter le scroll du menu mobile
            if (mobileMenu) {
                mobileMenu.addEventListener("scroll", checkMenuScroll);
            }

            // Animation du menu burger
            if (burgerBtn) {
                burgerBtn.addEventListener("click", () => {
                    burgerBtn.classList.toggle("burger-open");
                    
                    if (mobileMenu.classList.contains("hidden")) {
                        // Ouvrir le menu
                        mobileMenu.classList.remove("hidden");
                        mobileMenu.style.transform = "translateY(-100%)";
                        mobileMenu.style.opacity = "0";
                        
                        // Forcer le reflow pour que les styles initiaux soient appliqués
                        mobileMenu.offsetHeight;
                        
                        // Animation d'entrée
                        setTimeout(() => {
                            mobileMenu.style.transform = "translateY(0)";
                            mobileMenu.style.opacity = "1";
                            
                            // Vérifier le scroll après l'ouverture du menu
                            setTimeout(checkMenuScroll, 350);
                        }, 10);
                    } else {
                        // Fermer le menu avec animation
                        mobileMenu.style.transform = "translateY(-100%)";
                        mobileMenu.style.opacity = "0";
                        
                        setTimeout(() => {
                            mobileMenu.classList.add("hidden");
                            if (scrollIndicator) {
                                scrollIndicator.classList.remove("visible");
                            }
                        }, 300);
                    }
                });
            }
            
            // Fermer le menu mobile lors d'un clic sur un lien
            const mobileLinks = mobileMenu ? mobileMenu.querySelectorAll("a") : [];
            mobileLinks.forEach(link => {
                link.addEventListener("click", () => {
                    if (burgerBtn) burgerBtn.classList.remove("burger-open");
                    if (mobileMenu) {
                        mobileMenu.style.transform = "translateY(-100%)";
                        mobileMenu.style.opacity = "0";
                        
                        setTimeout(() => {
                            mobileMenu.classList.add("hidden");
                            if (scrollIndicator) {
                                scrollIndicator.classList.remove("visible");
                            }
                        }, 300);
                    }
                });
            });
            
            // Touche ESC pour fermer la recherche, le menu mobile et le modal
            document.addEventListener("keydown", function(e) {
                if (e.key === "Escape") {
                    // Fermer le modal de déconnexion
                    if (logoutModal && !logoutModal.classList.contains("hidden")) {
                        closeModal();
                    }
                    
                    // Fermer la recherche tablette
                    const searchContainer = document.getElementById("tabletSearchContainer");
                    const searchIcon = document.getElementById("tabletSearchIcon");
                    
                    if (searchContainer && searchContainer.classList.contains("active")) {
                        searchContainer.classList.remove("active");
                        if (searchIcon) searchIcon.classList.remove("active");
                        
                        // Vider le champ de recherche et les résultats
                        const searchInput = document.getElementById("searchRecipeTablet");
                        const searchResults = document.getElementById("recipeResultsTablet");
                        
                        if (searchInput) searchInput.value = "";
                        if (searchResults) {
                            searchResults.innerHTML = "";
                            searchResults.classList.add("hidden");
                        }
                    }
                    
                    // Fermer le menu mobile
                    if (mobileMenu && !mobileMenu.classList.contains("hidden")) {
                        if (burgerBtn) burgerBtn.classList.remove("burger-open");
                        mobileMenu.style.transform = "translateY(-100%)";
                        mobileMenu.style.opacity = "0";
                        
                        setTimeout(() => {
                            mobileMenu.classList.add("hidden");
                            if (scrollIndicator) {
                                scrollIndicator.classList.remove("visible");
                            }
                        }, 300);
                    }
                }
            });
            
            // Vérifier le scroll lors du redimensionnement de la fenêtre
            window.addEventListener("resize", checkMenuScroll);
        });
    </script>
</body>
</html>